BootStrap: yum
OSVersion: 7
MirrorURL: http://mirror.centos.org/centos-%{OSVERSION}/%{OSVERSION}/os/x86_64/
Include: yum

%post
    # Update yum mirrorlinks
    cd /etc/yum.repos.d/
    sed -i 's/mirrorlist/#mirrorlist/g' /etc/yum.repos.d/CentOS-*
    sed -i 's|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g' /etc/yum.repos.d/CentOS-*
    # Install git
    yum install git -y
    # Install OpenMPI
    yum install openmpi-devel -y
    # Load OpenMPI module
    . /etc/profile
    module load mpi
    # Install g++
    yum install gcc-c++.x86_64 -y
    # Clone repo
    cd /usr/local
    git clone --recurse-submodule https://github.com/AndreaBarletta/SE4HPCDevOps2.git

%runscript
    # cd /usr/local/SE4HPCDevOps2/build
    # ./test_multiplication